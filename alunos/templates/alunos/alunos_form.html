{% extends 'base.html' %}
{% block title %}{{ view.object|default:'Novo aluno' }}{% endblock %}
{% block content %}
  <h1 class="text-2xl md:text-3xl font-bold mb-6">
    {{ view.object|yesno:"Editar aluno,Novo aluno" }}
  </h1>

  <form method="post" class="bg-white rounded-2xl shadow p-6 space-y-6">
    {% csrf_token %}

    {% if form.non_field_errors %}
      <div class="rounded-xl border border-red-200 bg-red-50 text-red-700 px-4 py-2">
        {{ form.non_field_errors }}
      </div>
    {% endif %}

    <!-- básicos -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label class="block text-sm font-medium">Nome</label>
        {{ form.nome }}
        {% for e in form.nome.errors %}<p class="text-sm text-red-600">{{ e }}</p>{% endfor %}
      </div>
      <div>
        <label class="block text-sm font-medium">Telefone</label>
        {{ form.telefone }}
        {% for e in form.telefone.errors %}<p class="text-sm text-red-600">{{ e }}</p>{% endfor %}
      </div>
      <div>
        <label class="block text-sm font-medium">CPF</label>
        {{ form.cpf }}
        {% for e in form.cpf.errors %}<p class="text-sm text-red-600">{{ e }}</p>{% endfor %}
      </div>
      <div>
        <label class="block text-sm font-medium">Idade</label>
        {{ form.idade }}
        {% for e in form.idade.errors %}<p class="text-sm text-red-600">{{ e }}</p>{% endfor %}
      </div>
    </div>

    <!-- endereço -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label class="block text-sm font-medium">Rua</label>
        {{ form.rua }}
        {% for e in form.rua.errors %}<p class="text-sm text-red-600">{{ e }}</p>{% endfor %}
      </div>
      <div>
        <label class="block text-sm font-medium">Bairro</label>
        {{ form.bairro }}
        {% for e in form.bairro.errors %}<p class="text-sm text-red-600">{{ e }}</p>{% endfor %}
      </div>
      <div>
        <label class="block text-sm font-medium">Cidade</label>
        {{ form.cidade }}
        {% for e in form.cidade.errors %}<p class="text-sm text-red-600">{{ e }}</p>{% endfor %}
      </div>
      <div>
        <label class="block text-sm font-medium">CEP</label>
        {{ form.cep }}
        {% for e in form.cep.errors %}<p class="text-sm text-red-600">{{ e }}</p>{% endfor %}
      </div>
    </div>

    <!-- outros -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label class="block text-sm font-medium">Cor</label>
        {{ form.cor }}
        {% for e in form.cor.errors %}<p class="text-sm text-red-600">{{ e }}</p>{% endfor %}
      </div>
      <div>
        <label class="block text-sm font-medium">Escolaridade</label>
        {{ form.escolaridade }}
        {% for e in form.escolaridade.errors %}<p class="text-sm text-red-600">{{ e }}</p>{% endfor %}
      </div>
    </div>

    <!-- responsáveis (novo bloco) -->
    <div class="grid grid-cols-1 gap-2">
      <label class="block text-sm font-medium">Responsáveis</label>
      <div class="flex items-start gap-3">
        <div class="min-w-[280px]">
          {{ form.responsaveis }}
          {% if form.responsaveis.help_text %}
            <p class="text-xs text-gray-500 mt-1">{{ form.responsaveis.help_text }}</p>
          {% endif %}
          {% for e in form.responsaveis.errors %}
            <p class="text-sm text-red-600">{{ e }}</p>
          {% endfor %}
        </div>
        <a href="{% url 'responsaveis:create' %}" target="_blank"
           class="px-3 py-2 rounded-lg border hover:bg-gray-50">
           + Novo responsável
        </a>
      </div>
    </div>

    <div class="flex gap-2">
      <button class="px-4 py-2 rounded-xl bg-gray-900 text-white">Salvar</button>
      <a href="{% url 'alunos:list' %}" class="px-4 py-2 rounded-xl border">Cancelar</a>
    </div>
  </form>
{% endblock %}
